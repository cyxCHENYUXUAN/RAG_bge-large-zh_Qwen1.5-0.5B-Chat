{
  "original_filename": "1747146827_第9章-磁盘存储器的管理.pdf",
  "processed_at": "2025-05-13T22:33:47.367559",
  "chunks": [
    {
      "text": "--- 第1页 ---\n第1/85页\n第\n9\n章\n文件管理\n9.1  外存的组织方式\n9.2  文件存储空间的管理\n9.3  提高磁盘 I/O速度的途径\n9.4  提高磁盘可靠性的 技术\n9.5  存储新技术\n9.6  数据一致性控制\n\n--- 第2页 ---\n第2/85页\n文件结构\n文件结构\n指文件中信息的配置和构造方式 ，应该从文件的\n逻辑结构及文件的物理结构两方面考虑 。\n文件的逻辑结构\n从用户观点出发 ，所观察到的文件组织形式 ，这\n是用户能观察到 ，可加以处理的数据集合 。\n文件的物理结构\n文件在外存上的存储组织形式 ，数据被文件系统\n按照某种规则排列和存放到物理存储介质上 。\n\n--- 第3页 ---\n第3/85页\n文件的物理\n 结构\n文件的\n物理结构 直接与外存的组织 方式有关\n在采用不同的组织方式时，将形成不同的文件物\n理结构。外存组织方式也称为外存分配方式。\n三种外存组织方式\n连续组织方式\n →连续结构\n链接组织方式 →链接结构\n索引组织方式\n →索引结构\n通常，在一个系统中，只能采用其中一种方法来\n为文件分配外存空间\n\n--- 第4页 ---\n4\n3\n第4/85页\n连续组织\n 方式\n连续组织方式又称为连续分配方式\n基本思想\n一个文件的信息存放在若干连续的物理块中\n\n--- 第5页 ---\n第5/85页\n连续组织\n 方式\n连续组织方式又称为连续分配方式\n基本思想\n一个文件的信息存放在若干连续的物理块中\n\n--- 第6页 ---\n第6/85页\n连续组织\n 方式\n优点\n顺序访问容易\n顺序存取速度快，所需的磁盘寻道次数和寻道\n时间最少\n缺点\n外部碎片问题\n必须事先知道文件的长度\n文件不能动态增长：\n（1）预留空间 : 浪费；（ 2）重新分配和移动\n\n--- 第7页 ---\n第7/85页\n链接组织\n 方式\n将文件存储在多个离散的盘块中。存放文件信息的每\n一物理块中有一个指针，指向下一个物理块。\n通过链接指针，将同属于一个文件的多个离散的盘块\n链接成一个链表，形成的物理文件称为链接文件。\n主要优点：\n消除了磁盘的外部碎片，提高外存的利用率\n对插入、删除和修改记录都非常容易\n能使用文件的动态增长，无需事先知道文件的大小\n两种链接方式\n隐式链接\n显式链接\n\n--- 第8页 ---\n第8/85页\n链接组织\n 方式\n--\n隐\n式链接",
      "chunk_index": 0
    },
    {
      "text": "方式\n--\n隐\n式链接\n\n --- 第9页 ---\n第10/85页\n链接组织\n 方式\n--\n隐\n式链接\n\n--- 第10页 ---\n第11/85页存在的问题\n顺序存取效率高 ，随机存取效率太低 ，如果访问文\n件的最后的内容 ，实际上是要访问整个文件；\n存在可靠性问题 ，如指针出错等；\n链接指针占用一定的空间。\n隐式链接\n\n--- 第11页 ---\n第12/85页\n显示链接\n把用于链接文件各物理\n块的指针，从每个物理\n块的末尾 提取出来， 显\n式地存放在一张链接表\n中。\n该表在整个磁盘只有一\n张，称为 文件分配表\n（FAT）。\n一个磁盘分区能分为多\n少块, 则FAT就有多少个\n表项0\n1\nN-110\nN-1\n磁盘 FAT\n\n--- 第12页 ---\n第13/85页\n文件分配表（\n FAT\n）\n例：在文件目录中只存放第一个盘块号，在 FAT文件分配\n表的每个表项中存放下一个盘块号。\nEOF0\n217\n618\nFAT339618\n339\nt30\n217\n618\n磁盘t2t1\n339217 文件名 test…\nFAT表在系统启动时就会被读入内存，因此查找记录的过\n程是在内存中进行的，因而不仅显著提高了检索速度，而\n且明显减少了访问磁盘的次数。\n\n--- 第13页 ---\n第14/85页例： 200MB硬盘，盘块大小 =1KB，共有 个盘块，每\n个盘块在 FAT表中占 1个表项， FAT表共有 个表项\n若每个表项占 2.5个字节，则 FAT共占\n例：12G硬盘，盘块大小 =4KB，共有 个盘块，每个盘 块\n在FAT表中占 1个表项， FAT表共有个表项，若每个\n表项占 3个字节，则 FAT共占\n文件分配表（\n FAT\n）\n200K\n200K\n500KB=200*2.5\n3M\n3M\n9M=3M*3\n\n--- 第14页 ---\n第15/85页主要优点\n存储空间利用率高\n能够动态的分配盘块\n增、删、改方便\n主要缺点\n不能支持高效的直接存取\nFAT需要占用较大的内存空间\n显示链接\n\n--- 第15页 ---\n第16/85页\n索引\n分配\n而事实上，在打开某个文件时，只需要将该文件对\n应盘块的编号调入内存即可，完全没有必要将整个\nFAT调入内存。\n为此，应将每个文件所对应的盘块号集中地放在一\n起，在访问到某个文件时，再将该文件所对应的盘\n块号一起调入内存 。",
      "chunk_index": 1
    },
    {
      "text": "。\n\n --- 第16页 ---\n第17/85页\n索引\n分配\n—\n单级索引组织方式\n基本思想\n系统为每个文件建立一个专用数据结构 ——索引表，\n并将分配给该文件的所有盘块号（可能是不连续的）\n都记录在索引表中 。\n在建立一个文件时，只需在为之建立的目录项中填\n上指向该索引块的指针即可 。\n索引表目：逻辑块号，物理块号。\n索引表位置： 在文件目录中指出索引表所在的盘块，\n通常采用一个 专门的盘块作为索引表\n文件访问\n根据文件的逻辑块号查文件索引表，找到对应的物\n理块号，然后进行访问 。\n\n--- 第17页 ---\n第18/85页\n索引图示\n\n--- 第18页 ---\n第19/85页\n索引图示\n此块为索\n引块\n\n--- 第19页 ---\n第20/85页\n索引分配的优缺点\n优点\n既能顺序存取 ,又能随机存取\n满足了文件动态增长、插入删除的要求\n能充分利用外存空间\n缺点\n较多的寻道次数和寻道时间\n索引表本身带来了系统开销，当索引块需要占用\n若干个盘块号时，利用率将会很低 。\n如：外存空间，存取时间\n\n--- 第20页 ---\n第21/85页多级\n索引\n如果索引表过大，可为索引表本身再建立索引表，\n缩短索引表长度。可以按照如下方式组织成多级索引 表\n索引分配\n —\n多\n级索引组织方式\n\n--- 第21页 ---\n第22/85页\n索引分配\n —\n多\n级索引组织方式\n\n--- 第22页 ---\n第23/85页\n混合（增量式）索引组织方式\n对于小文件（如\n大小为 1KB -\n10KB或4KB -\n40KB）\n可直接寻址\n（直接从 FCB\n获得文件的盘\n块地址）00 00 00 00\n对于中文件（如\n大小为 11KB -\n256KB或5KB -\n4MB）\n可一次间接地\n址（从 FCB中\n找到该文件的\n索引表）对于大型和特\n大型文件\n可二次或三\n次间址（两\n级或三级索\n引组织方式）混合索引组织 方\n式（增量式索引\n组织方式）\n既采用直接寻\n址方式，又采\n用单级和多级\n索引组织方式\n（间接寻址方\n式）\n\n--- 第23页 ---\n第24/85页\n混合\n（\n增量式）\n 索引组织方式",
      "chunk_index": 2
    },
    {
      "text": "索引组织方式\n\n --- 第24页 ---\n1. \n在\n以下文件的物理结构中，不利于文件长度动态增长的是（\n ）。\nA \n连续结构\n B \n链接结构\n C \n索引结构\n D \n散列结构\n2. \n在\n磁盘上，最容易导致存储碎片发生的物理文件结构是（\n ）。\nA \n隐式链接\n B \n顺序存放\n C \n索引存放\n D \n显式链接\n3. \n文件\n的物理组织方式是由（\n ）确定的。\nA \n应用程序\n B \n主存容量\n C \n外存容量\n D \n操作系统\n4. \n【\n2009\n统考真题\n 】\n下列文件物理结构中，适合随机访问且易于文件扩展\n的是（\n ）。\nA \n连续结构\n B \n索引结构\n C\n链接结构且磁盘块定长\nD \n链式结构且磁盘块变\n 长\n5. \n文件系统采用两级索引分配方式，若每个磁盘块的大小为\n 1KB\n，每个盘\n块号占\n 4B\n，则该系统中，单个文件的最大长度\n 是（\n ）。\nA 64MB           B 128MB\n C 32MB\n D \n以上答案都不对\nA\nB\nD\nB\n思考题\n𝟏𝑲𝑩\n𝟒𝑩=𝟐𝟖\n𝟐𝟖×𝟐𝟖×𝟏𝑲𝑩\nA\n\n--- 第25页 ---\n6. \n【\n2010\n统考真题\n 】\n设文件索引结点中有\n 7\n个地址项，其中\n 4\n个地址项\n是直接地址索引，\n 2\n个地址项是一级间接地址索引，\n 1\n个地址项是二级\n间接地址索引，每个地址项大小为\n 4B\n，若磁盘索引块和磁盘数据块大\n小均为\n 256B\n，则可表示的单个文件的最大长度是\n （\n）。\nA \n32KB\n B \n519KB\n C\n1057KB\n D \n16546KB\n答：每个磁盘索引块和磁盘数据块大小均为\n 256B\n，每个磁盘索引块有\n 个\n地址项。𝟐𝟓𝟔/𝟒=𝟐𝟔\n因此，\n 4\n个直接地址索引指向的数据块大小为 𝟐𝟓𝟔𝑩×𝟒\n2\n个一级间接索引包含的直接地址索引数为 𝟐𝟓𝟔/𝟒×𝟐\n即其指向的数据块大小为 𝟐𝟓𝟔/𝟒×𝟐×𝟐𝟓𝟔𝑩\n1\n个二级间接索引包含的直接地址索引数为 𝟐𝟓𝟔/𝟒×𝟐𝟓𝟔/𝟒\n即其指向的数据块大小为 𝟐𝟓𝟔/𝟒×𝟐𝟓𝟔/𝟒×𝟐𝟓𝟔𝑩\n𝟏𝟎𝟖𝟐𝟑𝟔𝟖 𝐁=𝟏𝟎𝟓𝟕𝐊𝐁\nC\n思考题",
      "chunk_index": 3
    },
    {
      "text": "𝐁=𝟏𝟎𝟓𝟕𝐊𝐁\nC\n思考题\n\n --- 第26页 ---\n7. \n【\n2018\n统考真题\n 】\n某文件系统采用索引结点存放文件的属性和地址信\n息，簇大小为\n 4KB\n，每个文件索引结点占\n 64B\n，有\n 11\n个地址项，其中直\n接地址项\n 8\n个，一级、二级和三级间接地址项各\n 1\n个，每个地址项长度为\n4B\n，请回答下列问题：\n1\n）该文件系统能支持的最大文件长度是多少？（给出计算表达式即可）\n答：簇大小为\n 4KB\n，每个地址项长度为\n 4B\n，因此每簇\n 有\n 个地址项。 𝟒𝑲𝑩/𝟒=𝟏𝟎𝟐𝟒\n最大文件的物理块数可达 𝟖+𝟏×𝟏𝟎𝟐𝟒+𝟏×𝟏𝟎𝟐𝟒𝟐+𝟏×𝟏𝟎𝟐𝟒𝟑\n每个物理块（簇）大小为\n 4KB\n，因此，文件的最大长度为\n𝟖+𝟏×𝟏𝟎𝟐𝟒+𝟏×𝟏𝟎𝟐𝟒𝟐+𝟏×𝟏𝟎𝟐𝟒𝟑×𝟒𝑲𝑩\n=𝟑𝟐𝑲𝑩+𝟒𝑴𝑩+𝟒𝑮𝑩+𝟒𝑻𝑩\n思考题\n\n--- 第27页 ---\n答：文件索引结点总个数为 𝟏𝑴×𝟒𝑲𝑩/𝟔𝟒𝑩=𝟔𝟒𝑴\n5600B\n的\n文件占\n 个\n簇，（提示，簇的大小为\n 4KB\n，并且以簇为基本分配单位） 𝟐\n512M\n个簇可以存放的文件总个数为𝟓𝟏𝟐𝑴\n𝟐=𝟐𝟓𝟔𝑴\n可表示的文件总个数受限于文件索引结点总个数，因此能存储\n 个\n大小为\n 5600B\n的图像文件。𝟐𝟓𝟔𝑴\n𝟒=𝟔𝟒𝑴\n思考题\n7. \n【\n2018\n统考真题\n 】\n某文件系统采用索引结点存放文件的属性和地址信\n息，簇大小为\n 4KB\n，每个文件索引结点占\n 64B\n，有\n 11\n个地址项，其中直接\n地址项\n 8\n个，一级、二级和三级间接地址项各\n 1\n个，每个地址项长度为\n 4B\n，\n请回答下列问题：\n2\n）文件系统用\n 1M\n个簇存放文件索引结点，用\n 512M\n个簇存放文件数据。\n若一个图像文件的大小为\n 5600B\n，则该文件系统最多能存放多少个这样的\n图像文件？",
      "chunk_index": 4
    },
    {
      "text": "5600B\n，则该文件系统最多能存放多少个这样的\n图像文件？\n\n --- 第28页 ---\n思考题\n7. \n【\n2018\n统考真题\n 】\n某文件系统采用索引结点存放文件的属性和地址信\n息，簇大小为\n 4KB\n，每个文件索引结点占\n 64B\n，有\n 11\n个地址项，其中直接\n地址项\n 8\n个，一级、二级和三级间接地址项各\n 1\n个，每个地址项长度为\n 4B\n，\n请回答下列问题：\n3\n）若文件\n F1\n的大小为\n 6KB\n，文件\n F2\n的大小为\n 40KB\n，则该文件系统获取\nF1\n和\nF2\n最后一个簇的簇号需要的时间是否相同？为什么？\n答：文件\n F1\n的大小\n为𝟔𝑲𝑩<𝟒𝑲𝑩×𝟖=𝟑𝟐𝑲𝑩，\n因此获取文件\n F1 \n的最后一个\n簇的簇号只需要访问索引结点的\n 直接地址项\n 。\n文件\n F2\n大小为\n 40KB\n，\n4KB×\n8<\n40KB<\n4KB×\n8+4KB×\n1024\n。\n因此\n获取\n F2 \n的\n最后一个簇的簇号还需要读\n 一级索引表\n 。综上，需要的时间不相同。\n\n--- 第29页 ---\n第30/85页\n文件存储空间\n 管理\n为了实现任何一种文件组织方式，都\n 需要为文件分配\n盘块，必须知道磁盘上 哪些盘块是可用于分配 的。\n故在为文件分配磁盘时\n ，系统还应为可分配存储空间\n设置相应的数据结构 ——磁盘分配表 （Disk \nAllocation Table ），用于 记住可供分配的存储空间\n情况。此外，还需要提供对盘块进行分配和回收的手\n段。\n存储空间的基本分配单位是\n 磁盘块而非字节 。\n\n--- 第30页 ---\n第31/85页\n文件存储空间\n 管理\n常用\n的空闲文件存储空间的管理方法有 ：\n空闲块表法\n空闲链法\n位示图法\n成组链接 法\n\n--- 第31页 ---\n第32/85页\n空闲块表法\n将所有空闲区记录在一个表中，即\n 空闲块表 。\n属于\n连续分配方式\n空闲块的分配与内存的可变分区分配方式类似\n\n--- 第32页 ---\n第33/85页\n空闲链\n法\n把所有空闲块链接成一个链。\n链表分成两种形式\n空闲盘块链 ：以空闲块为单位 形成的链表\n空闲盘区 链：以连续空闲块为单位 形成的链表",
      "chunk_index": 5
    },
    {
      "text": "形成的链表\n\n --- 第33页 ---\n第34/85页\n位示图\n法\n位示图是利用二进制位 0,1来表示磁盘中的一个盘块\n的使用情况，每个物理块对应一位，磁盘上所有的盘\n块都有一个二进制位与之对应 。\n空闲\n：0；已分配： 1（或者相反 ）\n位示图的大小依据物理磁盘的容量而 定\n例：360KB的磁盘，每个物理块为 512字节\n位示图占用（ 360*1024 ）/512/8=90 个字节\n由所有存储块对应的位构成一个集合，称为位示图 。\n通常可用\n 𝒎×𝒏个位来构成位示图，并使 𝒎×𝒏等于\n磁盘的总块数。\n\n--- 第34页 ---\n第35/85页\n位示图\n法\n位示图也可以描述为一个二维数组 map[ m,n]\n\n--- 第35页 ---\n第36/85页\n空闲块的分配\nn代表每行的\n位数\n\n--- 第36页 ---\n第37/85页\n空闲块的回收\n\n--- 第37页 ---\n假定\n一个盘组共有\n 100\n个柱面，每个柱面上有\n 16\n个磁道，每个磁道分\n成\n4\n个扇区。\n1\n）整个磁盘空间有多少存储块？ 𝟒×𝟏𝟔×𝟏𝟎𝟎=𝟔𝟒𝟎𝟎\n2\n）若用字长\n 32\n位的\n单元来构造位示图，共需要多少个字？\n答：位示图应为\n 6400\n个位，如果用字长为\n 32\n位（即\n𝒏\n=\n𝟑𝟐\n）的单元来构\n造位示图，那么需要\n 个字\n。 𝟔𝟒𝟎𝟎\n𝟑𝟐=𝟐𝟎𝟎\n3\n）位示图中第\n 18\n个字的第\n 16\n位对应的块号是多少？\n𝒃\n=\n𝒏\n×\n𝒊\n−\n𝟏\n+\n𝒋\n𝒃\n=\n𝟑𝟐\n×\n𝟏𝟖\n−\n𝟏\n+\n𝟏𝟔\n=\n𝟓𝟔𝟎\n思考题",
      "chunk_index": 6
    },
    {
      "text": "16\n位对应的块号是多少？\n𝒃\n=\n𝒏\n×\n𝒊\n−\n𝟏\n+\n𝒋\n𝒃\n=\n𝟑𝟐\n×\n𝟏𝟖\n−\n𝟏\n+\n𝟏𝟔\n=\n𝟓𝟔𝟎\n思考题\n\n --- 第38页 ---\n【\n2015\n统考真题\n 】\n文件系统用位示图法表示磁盘空间的分配情况，位\n图存于磁盘的\n 32~127\n号块中，每个盘块占\n 1024B\n，盘块和块内字节均\n从\n0\n开始编号。假设要释放的盘块号为\n 409612\n，则位图中要修改的位\n所在的盘块号和块内字节序号分别是\n （\n）。\nA 81,1\n B 81,2\n C 82,1\n D 82,2\nC\n答：\n盘块号\n=\n起始块号\n +\n盘块号\n/\n(\n𝟏𝟎𝟐𝟒\n×\n𝟖\n)\n=\n𝟑𝟐\n+\n𝟒𝟎𝟗𝟔𝟏𝟐\n/\n(\n𝟏𝟎𝟐𝟒\n×\n𝟖\n)\n=\n𝟑𝟐\n+\n𝟓𝟎\n=\n𝟖𝟐\n所求为块内字节号而不是位号，因此还需要除以\n 8\n，\n块内字节号\n =\n(\n盘块号\n%\n(\n𝟏𝟎𝟐𝟒\n×\n𝟖\n)\n)\n/\n𝟖\n=\n(\n𝟒𝟎𝟗𝟔𝟏𝟐%\n 𝟏𝟎𝟐𝟒\n×\n𝟖\n)\n/\n𝟖\n=\n𝟏\n思考题\n\n--- 第39页 ---\n第40/85页\n成组链接\n 法\n实现方法\n文件区中的所有空闲盘块，被分成若干个 组。\n将每一组含有的盘块总数 N和该组所有的盘块号，记入其 前\n一组的第一个盘块的 S.free(0)~S.free(99)中。\n将第一组的盘块总数和所有的盘块号，记入 空闲盘块号栈\n中，作为当前可供分配的空闲盘块号\n最末一组只有 99个盘块\nUNIX系统采用成组链接法\n\n--- 第40页 ---\n第41/85页\n成组链接法\n\n--- 第41页 ---\n某系统采用成组链接法管理磁盘的空闲空间，自前磁盘的盘央链接情\n况处于图示状态。首先由进程\n A\n申请\n 3\n个物理块，再由进程\n B\n释放\n 4\n个\n物理块\n 155 \n、\n182\n、\n191\n、\n163\n，试分别画图说明\n A\n申请后和\n B\n释放后的\n盘块链接情况。\n思考题",
      "chunk_index": 7
    },
    {
      "text": "B\n释放后的\n盘块链接情况。\n思考题\n\n --- 第42页 ---\n某系统采用成组链接法管理磁盘的空闲空间，自前磁盘的盘央链接情\n况处于图示状态。首先由进程\n A\n申请\n 3\n个物理块，再由进程\n B\n释放\n 4\n个\n物理块\n 155 \n、\n182\n、\n191\n、\n163\n，试分别画图说明\n A\n申请后和\n B\n释放后的\n盘块链接情况\n 。\n答：\n（\n1\n）进程\n A\n申请\n 3\n个物理块之后盘块的链接情况如下图所示\n 。\n思考题\n\n--- 第43页 ---\n某系统采用成组链接法管理磁盘的空闲空间，自前磁盘的盘央链接情\n况处于图示状态。首先由进程\n A\n申请\n 3\n个物理块，再由进程\n B\n释放\n 4\n个\n物理块\n 155 \n、\n182\n、\n191\n、\n163\n，试分别画图说明\n A\n申请后和\n B\n释放后的\n盘块链接情况\n 。\n答：（\n 2\n）进程\n B\n释放\n 4\n个物理块之后盘块的链接情况如下图所示。\n思考题",
      "chunk_index": 8
    }
  ]
}